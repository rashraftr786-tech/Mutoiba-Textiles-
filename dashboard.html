<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="css/style.css">
    <title>Dashboard | Mutoiba Textiles</title>
</head>
<body>
    <nav class="nav-bar">
        <strong>Mutoiba Textiles</strong>
        <div class="nav-links">
            <a href="customers.html">Customers</a>
            <a href="stocks.html">Inventory</a>
            <a href="#" id="logout-btn">Logout</a>
        </div>
    </nav>

    <div style="padding: 2rem; max-width: 1000px; margin: auto;">
        <h1>Shop Overview</h1>
        
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-top: 20px;">
            
            <div class="card" style="text-align: center; border-bottom: 5px solid var(--accent);">
                <h2 style="margin-bottom: 10px;">ðŸ§¾ Billing</h2>
                <p>Generate new bills & receipts</p>
                <a href="customers.html" class="button-link" style="display:block; background: var(--accent); color: white; padding: 10px; border-radius: 5px; text-decoration: none; font-weight: bold;">New Bill</a>
            </div>

            <div class="card" style="text-align: center; border-bottom: 5px solid var(--primary);">
                <h2 style="margin-bottom: 10px;">ðŸ“¦ Stocks</h2>
                <p id="item-count">Loading...</p>
                <a href="stocks.html" style="display:block; background: var(--primary); color: white; padding: 10px; border-radius: 5px; text-decoration: none; font-weight: bold;">Manage Stock</a>
            </div>

            <div class="card" style="text-align: center; border-bottom: 5px solid #2ecc71;">
                <h2 style="margin-bottom: 10px;">ðŸ‘¥ Customers</h2>
                <p id="cust-count">Loading...</p>
                <a href="add-customer.html" style="display:block; background: #2ecc71; color: white; padding: 10px; border-radius: 5px; text-decoration: none; font-weight: bold;">Add Customer</a>
            </div>

        </div>
    </div>

    <script type="module">
        import { auth, db } from './js/firebase.js';
        import { collection, getDocs } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
        import { onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

        onAuthStateChanged(auth, (user) => {
            if (!user) window.location.href = 'index.html';
        });

        document.getElementById('logout-btn').onclick = () => signOut(auth);

        // Fetch Stats
        const custSnap = await getDocs(collection(db, "customers"));
        document.getElementById('cust-count').innerText = custSnap.size + " Total Customers";

        const stockSnap = await getDocs(collection(db, "stocks"));
        document.getElementById('item-count').innerText = stockSnap.size + " Items in Stock";
    </script>
</body>
</html>

